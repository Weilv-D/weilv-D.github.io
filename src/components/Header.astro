---
import ThemeToggle from './ThemeToggle';
import Search from './Search';
import { GRAVATAR_EMAIL } from '../consts';
import { createHash } from 'node:crypto';

const emailHash = createHash('md5').update(GRAVATAR_EMAIL.trim().toLowerCase()).digest('hex');
const avatarUrl = `https://www.gravatar.com/avatar/${emailHash}?s=200`;
---

<header class="sticky top-4 md:top-6 z-50 w-full max-w-4xl mx-auto px-4 md:px-8 mb-6 md:mb-8">
  <div class="glass-liquid flex justify-between items-center py-2 px-4 md:py-3 md:px-6 rounded-full transition-all duration-300 hover:shadow-xl hover:bg-white/70 dark:hover:bg-slate-900/70">
    <a href={import.meta.env.BASE_URL} class="flex items-center gap-2 md:gap-3 group">
        <div class="w-8 h-8 text-[var(--color-primary)] group-hover:rotate-180 transition-transform duration-700 ease-in-out">
        <img src={`${import.meta.env.BASE_URL}logo.svg`} alt="Logo" class="w-full h-full dark:invert" />
        </div>
        <span class="text-lg font-serif font-bold tracking-tight group-hover:opacity-80 transition-opacity hidden sm:block">未来回忆录</span>
    </a>
    
    <nav class="flex items-center gap-3 md:gap-6">
        <div class="hidden md:block">
            <Search client:load />
        </div>
        <a href={`${import.meta.env.BASE_URL}blog`} class="text-sm font-medium link-underline">Blog</a>
        <a href={`${import.meta.env.BASE_URL}about`} class="text-sm font-medium link-underline">About</a>
        <a href={`${import.meta.env.BASE_URL}about`} class="w-8 h-8 squircle overflow-hidden border border-[var(--color-border)] shadow-sm hover:shadow-md hover:scale-105 transition-all duration-300 ease-out">
            <img src={avatarUrl} alt="Avatar" class="w-full h-full object-cover" />
        </a>
        <ThemeToggle client:load />
    </nav>
  </div>
</header>
