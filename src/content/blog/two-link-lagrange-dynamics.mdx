---
title: '二连杆机械臂动力学方程：拉格朗日方法推导'
description: '基于点质量模型，使用拉格朗日方法推导平面二连杆机械臂的完整动力学方程（M, C, G矩阵）。'
pubDate: '2026-01-09'
category: 'Tech'
tags: ['Robotics', 'Dynamics', 'Math']
heroImage: '/two-link-diagram.svg'
---

本文记录平面二连杆机械臂（2R Robot Arm）动力学方程的推导过程。

推导采用 **欧拉-拉格朗日 (Euler-Lagrange)** 方法，并假设杆件质量集中于连杆末端（点质量模型）。

## 1. 模型与符号

考虑一个在竖直平面内运动的二连杆系统。

*   **广义坐标**: $\boldsymbol{q} = [q_1, q_2]^\top$
    *   $q_1$: 关节 1 角度（相对于水平 $x$ 轴）。
    *   $q_2$: 关节 2 角度（相对于第一杆）。
*   **物理参数**:
    *   $l_1, l_2$: 连杆长度。
    *   $m_1, m_2$: 连杆末端的点质量。
    *   $g$: 重力加速度，方向沿 $y$ 轴负向。

## 2. 运动学分析

计算动能需要先求出各质点的速度。

### 2.1 位置向量
根据几何关系，各质点坐标为：

质点 1 ($m_1$):
$$
\begin{aligned}
x_1 &= l_1 \cos q_1 \\
y_1 &= l_1 \sin q_1
\end{aligned}
$$

质点 2 ($m_2$):
$$
\begin{aligned}
x_2 &= l_1 \cos q_1 + l_2 \cos(q_1 + q_2) \\
y_2 &= l_1 \sin q_1 + l_2 \sin(q_1 + q_2)
\end{aligned}
$$
*(注：后续使用简写 $s_1 = \sin q_1, c_{12} = \cos(q_1+q_2)$ 等)*

### 2.2 速度向量
对时间 $t$ 求导得到速度：

质点 1:
$$
\begin{aligned}
\dot{x}_1 &= -l_1 \dot{q}_1 s_1 \\
\dot{y}_1 &= l_1 \dot{q}_1 c_1
\end{aligned}
$$

质点 2:
$$
\begin{aligned}
\dot{x}_2 &= -l_1 \dot{q}_1 s_1 - l_2 (\dot{q}_1 + \dot{q}_2) s_{12} \\
\dot{y}_2 &= l_1 \dot{q}_1 c_1 + l_2 (\dot{q}_1 + \dot{q}_2) c_{12}
\end{aligned}
$$

### 2.3 速度平方
计算 $v^2 = \dot{x}^2 + \dot{y}^2$：

质点 1:
$$
v_1^2 = l_1^2 \dot{q}_1^2
$$

质点 2:
$$
\begin{aligned}
v_2^2 &= (\dot{x}_2)^2 + (\dot{y}_2)^2 \\
&= l_1^2 \dot{q}_1^2 + l_2^2 (\dot{q}_1 + \dot{q}_2)^2 + 2 l_1 l_2 \dot{q}_1 (\dot{q}_1 + \dot{q}_2) (s_1 s_{12} + c_1 c_{12})
\end{aligned}
$$
利用三角恒等式 $\cos(A-B) = \cos A \cos B + \sin A \sin B$：
$$
v_2^2 = l_1^2 \dot{q}_1^2 + l_2^2 (\dot{q}_1 + \dot{q}_2)^2 + 2 l_1 l_2 \dot{q}_1 (\dot{q}_1 + \dot{q}_2) \cos q_2
$$

## 3. 能量计算

### 3.1 动能
系统总动能为：
$$
\begin{aligned}
T &= \frac{1}{2} m_1 v_1^2 + \frac{1}{2} m_2 v_2^2 \\
  &= \frac{1}{2} m_1 l_1^2 \dot{q}_1^2 + \frac{1}{2} m_2 \left[ l_1^2 \dot{q}_1^2 + l_2^2 (\dot{q}_1 + \dot{q}_2)^2 + 2 l_1 l_2 (\dot{q}_1^2 + \dot{q}_1 \dot{q}_2) c_2 \right]
\end{aligned}
$$
整理后：
$$
T = \frac{1}{2} (m_1 + m_2) l_1^2 \dot{q}_1^2 + \frac{1}{2} m_2 l_2^2 (\dot{q}_1 + \dot{q}_2)^2 + m_2 l_1 l_2 c_2 (\dot{q}_1^2 + \dot{q}_1 \dot{q}_2)
$$

### 3.2 势能
以 $y=0$ 为零势能面：
$$
\begin{aligned}
V &= m_1 g y_1 + m_2 g y_2 \\
  &= (m_1 + m_2) g l_1 s_1 + m_2 g l_2 s_{12}
\end{aligned}
$$

### 3.3 拉格朗日函数
$$
L = T - V
$$
拉格朗日方程为：
$$
\frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_k} \right) - \frac{\partial L}{\partial q_k} = \tau_k
$$

## 4. 方程推导

### 4.1 关节 2

1.  **对 $\dot{q}_2$ 求偏导**:
    $$
    \frac{\partial L}{\partial \dot{q}_2} = m_2 l_2^2 (\dot{q}_1 + \dot{q}_2) + m_2 l_1 l_2 c_2 \dot{q}_1
    $$

2.  **对时间 $t$ 求导**:
    注意 $c_2$ 是时间函数，$\frac{d}{dt}c_2 = -s_2 \dot{q}_2$。
    $$
    \begin{aligned}
    \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_2} \right) &= m_2 l_2^2 (\ddot{q}_1 + \ddot{q}_2) + m_2 l_1 l_2 (\ddot{q}_1 c_2 - \dot{q}_1 s_2 \dot{q}_2) \\
    &= (m_2 l_2^2 + m_2 l_1 l_2 c_2) \ddot{q}_1 + m_2 l_2^2 \ddot{q}_2 - m_2 l_1 l_2 s_2 \dot{q}_1 \dot{q}_2
    \end{aligned}
    $$

3.  **对 $q_2$ 求偏导**:
    $$
    \frac{\partial L}{\partial q_2} = \frac{\partial T}{\partial q_2} - \frac{\partial V}{\partial q_2}
    $$
    $$
    \begin{aligned}
    \frac{\partial T}{\partial q_2} &= -m_2 l_1 l_2 s_2 (\dot{q}_1^2 + \dot{q}_1 \dot{q}_2) \\
    \frac{\partial V}{\partial q_2} &= m_2 g l_2 c_{12}
    \end{aligned}
    $$

4.  **合并得到 $\tau_2$**:
    $$
    \tau_2 = (m_2 l_2^2 + m_2 l_1 l_2 c_2) \ddot{q}_1 + m_2 l_2^2 \ddot{q}_2 + m_2 l_1 l_2 s_2 \dot{q}_1^2 + m_2 g l_2 c_{12}
    $$

### 4.2 关节 1

1.  **对 $\dot{q}_1$ 求偏导**:
    $$
    \frac{\partial L}{\partial \dot{q}_1} = (m_1+m_2)l_1^2 \dot{q}_1 + m_2 l_2^2 (\dot{q}_1 + \dot{q}_2) + m_2 l_1 l_2 c_2 (2\dot{q}_1 + \dot{q}_2)
    $$
    整理得：
    $$
    \frac{\partial L}{\partial \dot{q}_1} = \left[ (m_1+m_2)l_1^2 + m_2 l_2^2 + 2m_2 l_1 l_2 c_2 \right] \dot{q}_1 + \left[ m_2 l_2^2 + m_2 l_1 l_2 c_2 \right] \dot{q}_2
    $$

2.  **对时间 $t$ 求导**:
    $$
    \begin{aligned}
    \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_1} \right) &= \left[ (m_1+m_2)l_1^2 + m_2 l_2^2 + 2m_2 l_1 l_2 c_2 \right] \ddot{q}_1 \\
    &\quad - 2 m_2 l_1 l_2 s_2 \dot{q}_2 \dot{q}_1 \\
    &\quad + \left[ m_2 l_2^2 + m_2 l_1 l_2 c_2 \right] \ddot{q}_2 \\
    &\quad - m_2 l_1 l_2 s_2 \dot{q}_2 \dot{q}_2
    \end{aligned}
    $$
    整理得：
    $$
    \dots = M_{11} \ddot{q}_1 + M_{12} \ddot{q}_2 - 2 m_2 l_1 l_2 s_2 \dot{q}_1 \dot{q}_2 - m_2 l_1 l_2 s_2 \dot{q}_2^2
    $$

3.  **对 $q_1$ 求偏导**:
    $$
    \frac{\partial L}{\partial q_1} = - \frac{\partial V}{\partial q_1} = - [ (m_1+m_2)g l_1 c_1 + m_2 g l_2 c_{12} ]
    $$

4.  **合并得到 $\tau_1$**:
    $$
    \tau_1 = M_{11} \ddot{q}_1 + M_{12} \ddot{q}_2 - 2 m_2 l_1 l_2 s_2 \dot{q}_1 \dot{q}_2 - m_2 l_1 l_2 s_2 \dot{q}_2^2 + G_1
    $$

## 5. 动力学方程矩阵形式

标准形式为 $M(\boldsymbol{q})\ddot{\boldsymbol{q}} + C(\boldsymbol{q}, \dot{\boldsymbol{q}})\dot{\boldsymbol{q}} + \boldsymbol{G}(\boldsymbol{q}) = \boldsymbol{\tau}$。

### 5.1 惯性矩阵
$$
M(\boldsymbol{q}) = 
\begin{bmatrix}
(m_1 + m_2) l_1^2 + m_2 l_2^2 + 2 m_2 l_1 l_2 c_2 & m_2 l_2^2 + m_2 l_1 l_2 c_2 \\
m_2 l_2^2 + m_2 l_1 l_2 c_2 & m_2 l_2^2
\end{bmatrix}
$$

### 5.2 科氏力与离心力项
定义 $h = m_2 l_1 l_2 \sin q_2$，采用 Christoffel 符号构造：
$$
C(\boldsymbol{q}, \dot{\boldsymbol{q}}) = 
\begin{bmatrix}
-h \dot{q}_2 & -h (\dot{q}_1 + \dot{q}_2) \\
h \dot{q}_1 & 0
\end{bmatrix}
$$

### 5.3 重力项
$$
\boldsymbol{G}(\boldsymbol{q}) = 
\begin{bmatrix}
(m_1 + m_2) g l_1 \cos q_1 + m_2 g l_2 \cos(q_1 + q_2) \\
m_2 g l_2 \cos(q_1 + q_2)
\end{bmatrix}
$$

以上即为平面二连杆机械臂在点质量模型下的完整动力学方程。